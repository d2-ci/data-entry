(this["webpackJsonp@dhis2/app-shell"]=this["webpackJsonp@dhis2/app-shell"]||[]).push([[135],{688:function(e,t,a){},689:function(e,t,a){e.exports={container:"categories-menu_container__gcKJ6",inputs:"categories-menu_inputs__23WFq",input:"categories-menu_input__LOiJY"}},690:function(e,t,a){e.exports={menuSelect:"menu-select_menuSelect__2wY8M"}},691:function(e,t,a){e.exports={itemContentContainer:"org-unit-selector-bar-item_itemContentContainer__2CxCn",searchInputContainer:"org-unit-selector-bar-item_searchInputContainer__Oxf6u",orgUnitTreeContainer:"org-unit-selector-bar-item_orgUnitTreeContainer__1JGBG"}},692:function(e,t,a){e.exports={wrapper:"error-message_wrapper__17C15"}},693:function(e,t,a){e.exports={menu:"period-menu_menu__CKEQa"}},694:function(e,t,a){e.exports={container:"year-navigator_container__3tWfA",year:"year-navigator_year__1-oYj"}},695:function(e,t,a){e.exports={wrapper:"layout_wrapper__t4ys_",showSidebar:"layout_showSidebar__3kRCf",showFooter:"layout_showFooter__2QEnR",header:"layout_header__32xI8",main:"layout_main__tku6I",sidebar:"layout_sidebar__2JyT-",footer:"layout_footer__3RbA5"}},702:function(e,t,a){"use strict";a.r(t);var r=a(8),n=a(0),o=a.n(n),i=a(22),l=a(701),s=a(675),c=a(683);a(688);const d={dataSetId:c.c,orgUnitId:c.c,periodId:c.c,attributeOptionComboSelection:Object(c.f)(c.a,[]),sectionFilter:c.c};function u(){return Object(c.d)("dataSetId",d.dataSetId)}function g(){return Object(c.d)("orgUnitId",d.orgUnitId)}function p(){return Object(c.d)("periodId",d.periodId)}function m(){return Object(c.d)("attributeOptionComboSelection",d.attributeOptionComboSelection)}function f(){return Object(c.d)("sectionFilter",d.sectionFilter)}function y(){return Object(c.e)(d)}var h=a(3),v=a(689),D=a.n(v);const b={dataSet:{resource:"dataSets",id:e=>{let{id:t}=e;return t},params:{fields:["categoryCombo[isDefault,displayName, categories[id, displayName, categoryOptions[id, displayName]]]"]}}};function S(){const[e]=u(),t=[b,{id:e}],{isIdle:a,isLoading:r,error:n,data:o}=Object(i.useQuery)(t,{enabled:!!e});return{called:!a,loading:r,error:n,data:null===o||void 0===o?void 0:o.dataSet.categoryCombo}}function E(e){var t;let{close:a,selected:n,onChange:i}=e;const l=S();return!l.called||l.loading?h.a.t("Loading categories..."):l.error?h.a.t("An error occurred loading the categories"):o.a.createElement("div",{className:D.a.container},o.a.createElement("div",{className:D.a.inputs},null===(t=l.data)||void 0===t?void 0:t.categories.map((e=>{let{id:t,displayName:a,categoryOptions:l}=e;return o.a.createElement("div",{className:D.a.input,key:t},o.a.createElement(r.x,{label:a,selected:n[t],onChange:e=>{let{selected:a}=e;return i({categoryId:t,selected:a})}},l.map((e=>{let{id:t,displayName:a}=e;return o.a.createElement(r.y,{key:t,value:t,label:a})}))))}))),o.a.createElement(r.c,{secondary:!0,onClick:(e,t)=>{t.stopPropagation(),a()}},h.a.t("Hide menu")))}const F=e=>e.reduce(((e,t)=>{const[a,r]=t.split(":");return{...e,[a]:r}}),{});function N(){const[e,t]=Object(n.useState)(!1),a=S(),{deselectAll:i,select:l,selected:s}=function(){const[e,t]=m(),[a,r]=Object(n.useState)((()=>F(e)));return Object(n.useEffect)((()=>{r(F(e))}),[e]),{select:e=>{let{value:n,categoryId:o}=e;const i=n?{...a,[o]:n}:function(e,t){const a={...t};return delete a[e],a}(o,a),l=Object.entries(i).map((e=>{let[t,a]=e;return"".concat(t,":").concat(a)}));r(i),t(l)},selected:a,deselectAll:()=>{r({}),t([])}}}(),c=function(){var e,t;const[a]=u(),[r]=p(),[n]=g(),o=S();return!a||!r||!n||!o.called||!(null!==(e=o.data)&&void 0!==e&&e.categories.length)||(null===(t=o.data)||void 0===t?void 0:t.isDefault)}(),d=function(){var e;const t=S();return!t.called||t.loading?h.a.t("Loading categories..."):t.error?h.a.t("Attribute option combination: An error occurred",{nsSeparator:"-:-"}):null===(e=t.data)||void 0===e?void 0:e.displayName}(),f=function(){const[e]=m(),t=S();if(!t.called||t.loading)return h.a.t("Loading...");if(t.error)return h.a.t("An error loading the values occurred");if(!e.length)return h.a.t("No selection!");if(t.data&&e.length<t.data.categories.length)return h.a.t("Partial selection!");if(t.data&&e.length===t.data.categories.length)return h.a.t("Complete selection!");const a=new Error("Case not implemented!");return console.error(a),""}();if(function(e){const t=Object(n.useRef)(!0),[a]=u(),[r]=p(),[o]=g();Object(n.useEffect)((()=>{t.current?t.current=!1:e()}),[a,o,r])}(i),c)return null;const y=a.called&&!a.loading&&!a.error&&a.data;return o.a.createElement(r.w,{label:d,value:f,open:e,setOpen:t,noValueMessage:h.a.t("Choose a data set")},a.error&&h.a.t("An error occurred loading the categories"),y&&o.a.createElement(E,{close:()=>t(!1),selected:s,onChange:e=>{let{selected:t,categoryId:a}=e;return l({value:t,categoryId:a})}}))}var O=a(690),w=a.n(O);function P(e){let{values:t,selected:a,onChange:n}=e;return o.a.createElement("div",{className:w.a.menuSelect},o.a.createElement(r.n,null,t.map((e=>{let{value:t,label:i}=e;return o.a.createElement(r.o,{key:t,label:i,active:a===t,onClick:()=>n({selected:t})})}))))}const C={dataSet:{resource:"dataSets",id:e=>{let{id:t}=e;return t},params:{fields:["id","displayName"]}}};const Y={dataSets:{resource:"dataSets",params:{paging:!1}}};function _(){var e;const[t,a]=Object(n.useState)(!1),[l,s]=u(),c=function(){const[e]=u(),{isIdle:t,isLoading:a,error:r,data:n}=Object(i.useQuery)([C,{id:e}],{enabled:!!e});return{called:!t,loading:a,error:r,data:null===n||void 0===n?void 0:n.dataSet}}(),d=function(){var e;const{isIdle:t,isLoading:a,error:r,data:n}=Object(i.useQuery)([Y]);return{called:!t,loading:a,error:r,data:null===n||void 0===n||null===(e=n.dataSets)||void 0===e?void 0:e.dataSets.map((e=>({...e,value:e.id,label:e.displayName})))}}(),g=c.loading?h.a.t("Fetching data set info"):c.error?h.a.t("Error occurred while loading data set info"):null===(e=c.data)||void 0===e?void 0:e.displayName,p=d.called&&!d.loading&&!d.error&&d.data;return o.a.createElement(r.w,{label:h.a.t("Data set"),value:l?g:void 0,open:t,setOpen:a,noValueMessage:h.a.t("Choose a data set")},d.loading&&h.a.t("Fetching data sets"),d.error&&h.a.t("Error occurred while loading data sets"),p&&o.a.createElement(P,{values:d.data,selected:l,onChange:e=>{let{selected:t}=e;s(t),a(!1)}}))}var x=a(2),j=a.n(x);function k(e){let{onChange:t}=e;const[a,i]=Object(n.useState)(""),l=function(e,t){const[a,r]=Object(n.useState)(e);return Object(n.useEffect)((()=>{const a=setTimeout((()=>r(e)),t);return()=>clearTimeout(a)}),[e,t]),a}(a,200);return Object(n.useEffect)((()=>{t(l)}),[t,l]),o.a.createElement(r.l,{dense:!0,value:a,name:"context-selection-org-unit-search",placeholder:h.a.t("Search org units"),onChange:e=>{let{value:t}=e;return i(t)}})}function I(e){let{children:t}=e;const[a]=u(),n=a?void 0:h.a.t("You must choose a data set first");return n?o.a.createElement(r.z,{content:n},(e=>{let{ref:a,onMouseOver:r,onMouseOut:n}=e;return o.a.createElement("div",{ref:a,onMouseOver:r,onMouseOut:n},t)})):t}var M=a(691),T=a.n(M);const W={dataSet:{resource:"dataSets",id:e=>{let{id:t}=e;return t},params:{fields:["organisationUnits[path]"]}}};function U(){const[e]=u(),t=[W,{id:e}],{isLoading:a,error:r,data:n}=Object(i.useQuery)(t,{enabled:!!e});return{data:null===n||void 0===n?void 0:n.dataSet.organisationUnits.map((e=>{let{path:t}=e;return t})),loading:a,error:r}}const A={orgUnits:{resource:"organisationUnits",params:e=>{let{searchTerm:t}=e;return{fields:["path"],filter:"displayName:ilike:".concat(t),paging:!1}}}};const R={orgUnit:{resource:"organisationUnits",id:e=>{let{id:t}=e;return t},params:{fields:["id","displayName","path"]}}};function Q(){const[e]=g(),t=[R,{id:e}],{isLoading:a,error:r,data:n}=Object(i.useQuery)(t,{enabled:!!e}),o=null===n||void 0===n?void 0:n.orgUnit;return{loading:a,error:r,data:e?o:void 0}}const $={orgUnits:{resource:"me",params:{fields:["organisationUnits[id]"]}}};function J(){const{isLoading:e,error:t,data:a}=Object(i.useQuery)([$]);return{data:null===a||void 0===a?void 0:a.orgUnits.organisationUnits.map((e=>{let{id:t}=e;return t})),loading:e,error:t}}const L=()=>o.a.createElement("div",{"data-test":"-loading",className:"jsx-814846266"},o.a.createElement(r.f,{small:!0}),o.a.createElement(j.a,{id:"814846266"},["div.jsx-814846266{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}"])),B=e=>{let{error:t}=e;return o.a.createElement("div",{"data-test":"-error"},h.a.t("Error: {{ ERRORMESSAGE }}",{ERRORMESSAGE:t,nsSeparator:">"}))};function q(){const[e,t]=Object(n.useState)(""),a=function(e){const t=[A,{searchTerm:e}],{isIdle:a,isLoading:r,error:o,data:l}=Object(i.useQuery)(t,{enabled:!!e});return{called:!a,loading:r,error:o,data:Object(n.useMemo)((()=>l?l.orgUnits.organisationUnits.map((e=>{let{path:t}=e;return t})):[]),[l])}}(e),[l,s]=Object(n.useState)(!1),{expanded:c,handleExpand:d,handleCollapse:p}=function(){const[e,t]=Object(n.useState)([]);return{expanded:e,handleExpand:a=>{let{path:r}=a;return t([...e,r])},handleCollapse:a=>{let{path:r}=a;return t(e.filter((e=>e!==r)))}}}(),[f]=u(),[,y]=g(),[,v]=m(),D=Q(),b=J(),S=U(),E=function(){var e;const t=Q(),a=J(),r=U();return a.loading||t.loading||r.loading?h.a.t("Fetching organisation unit info"):t.error||a.error||r.error?h.a.t("Error occurred while loading organisation unit info"):null===(e=t.data)||void 0===e?void 0:e.displayName}(),F=D.data?[D.data.path]:[],N=!f,O=function(e){let{filter:t,orgUnitPathsByName:a,dataSetOrgUnitPaths:r}=e;const n=r||[];return t?(""!==t?a:[]).filter((e=>n.includes(e))):n}({filter:e,orgUnitPathsByName:a.data,dataSetOrgUnitPaths:S.data}),w=""!==e&&!a.called||a.loading;return o.a.createElement(I,null,o.a.createElement(r.w,{disabled:N,label:h.a.t("Organisation unit"),value:E,open:l,setOpen:s,noValueMessage:h.a.t("Choose a organisation unit")},o.a.createElement("div",{className:T.a.itemContentContainer},o.a.createElement("div",{className:T.a.searchInputContainer},o.a.createElement(k,{onChange:t})),o.a.createElement("div",{className:T.a.orgUnitTreeContainer},w&&o.a.createElement(L,null),!w&&a.error&&o.a.createElement(B,{error:a.error}),!w&&!!e&&!O.length&&h.a.t("No organisation units could be found"),!w&&(!e||!!O.length)&&o.a.createElement(r.u,{singleSelection:!0,filter:O,roots:b.data||[],selected:F,expanded:c,handleExpand:d,handleCollapse:p,onChange:(e,t)=>{let{id:a}=e;t.stopPropagation(),y(a),s(!1),v([])}})))))}a(692);const V="Daily",G="Weekly",K="WeeklyWednesday",z="WeeklyThursday",H="WeeklySaturday",X="WeeklySunday",Z="BiWeekly",ee="Monthly",te="BiMonthly",ae="Quarterly",re="SixMonthly",ne="SixMonthlyApril",oe="Yearly",ie="FinancialApril",le="FinancialJuly",se="FinancialOct",ce="FinancialNov",de=new Set([V,G,K,z,H,X,Z,ee,te,ae,re,ne,oe,ie,le,se,ce]),ue=e=>de.has(e),ge=e=>[h.a.t("January"),h.a.t("February"),h.a.t("March"),h.a.t("April"),h.a.t("May"),h.a.t("June"),h.a.t("July"),h.a.t("August"),h.a.t("September"),h.a.t("October"),h.a.t("November"),h.a.t("December")][e],pe=()=>new Date(Date.now()),me=e=>{const t=parseInt(e,10)||0;return pe().getFullYear()+t},fe=(e,t)=>a=>{let r=[];const n=a.filterFuturePeriods,o=a.reversePeriods,i=me(a.offset),l=new Date("01 Jan ".concat(i));for(;l.getFullYear()===i;){const t={};t.startDate=e(l),t.endDate=t.startDate,t.displayName=t.startDate,t.iso=t.startDate.replace(/-/g,""),t.id=t.iso,r.push(t),l.setDate(l.getDate()+1)}return r=n?t(r):r,r=o?r.reverse():r,r},ye=(e,t,a)=>r=>{let n=[];const o=r.filterFuturePeriods,i=r.reversePeriods,l=me(r.offset),s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const a=new Date(e,0,4),r=a.getDay(),n=a,o=r-t;return o>0?n.setDate(a.getDate()-o):o<0&&(n.setDate(a.getDate()-o),n.setDate(n.getDate()-7)),n}(l,t.startDay);let c=1;for(;s.getFullYear()<=l;){const a={};a.startDate=e(s),a.iso="".concat(l).concat(t.shortName,"W").concat(c),a.id=a.iso,s.setDate(s.getDate()+6),a.endDate=e(s);const r=c;if(a.displayName="".concat(h.a.t("Week {{weekNumber}}",{weekNumber:r})," - ").concat(a.startDate," - ").concat(a.endDate),s.getFullYear()>l&&s.getDate()>=4)break;n.push(a),s.setDate(s.getDate()+1),c+=1}return n=o?a(n):n,n=i?n.reverse():n,n},he=(e,t)=>a=>{let r=[];const n=a.filterFuturePeriods,o=a.reversePeriods,i=me(a.offset),l=new Date("01 Jan ".concat(i)),s=l.getDay();let c=1;for(s<=4?l.setDate(l.getDate()-(s-1)):l.setDate(l.getDate()+(8-s));l.getFullYear()<=i;){const t={};t.iso="".concat(i,"BiW").concat(c),t.id=t.iso,t.startDate=e(l),l.setDate(l.getDate()+13),t.endDate=e(l);const a=c;if(t.displayName="".concat(h.a.t("Bi-Week {{biWeekNumber}}",{biWeekNumber:a})," - ").concat(t.startDate," - ").concat(t.endDate),l.getFullYear()>i&&l.getDate()>=4)break;r.push(t),l.setDate(l.getDate()+1),c+=1}return r=n?t(r):r,r=o?r.reverse():r,r},ve=(e,t)=>{const a=e=>{const t=e.getFullYear();let a=String(e.getMonth()+1);return a=a.length<2?"0".concat(a):a,t+a};return r=>{let n=[];const o=r.filterFuturePeriods,i=r.reversePeriods,l=me(r.offset),s=new Date("31 Dec ".concat(l));for(;s.getFullYear()===l;){const t={};t.endDate=e(s),s.setDate(1),t.startDate=e(s);const r=ge(s.getMonth());t.displayName="".concat(r," ").concat(l),t.iso=a(s),t.id=t.iso,n.push(t),s.setDate(0)}return n=o?t(n):n,n=i?n:n.reverse(),n}},De=(e,t)=>a=>{let r=[];const n=a.filterFuturePeriods,o=a.reversePeriods,i=me(a.offset),l=new Date("31 Dec ".concat(i));let s=6;for(;l.getFullYear()===i;){const t={};t.endDate=e(l),l.setDate(0),l.setDate(1),t.startDate=e(l);const a=ge(l.getMonth()),n=ge(l.getMonth()+1),o=l.getFullYear();t.displayName="".concat(a," - ").concat(n," ").concat(o),t.iso="".concat(i,"0").concat(s,"B"),t.id=t.iso,r.push(t),l.setDate(0),s--}return r=n?t(r):r,r=o?r:r.reverse(),r},be=(e,t)=>a=>{let r=[];const n=a.filterFuturePeriods,o=a.reversePeriods,i=me(a.offset),l=new Date("31 Dec ".concat(i));let s=4;for(;l.getFullYear()===i;){const t={};t.endDate=e(l),l.setDate(0),l.setDate(0),l.setDate(1),t.startDate=e(l);const a=ge(l.getMonth()),n=ge(l.getMonth()+2),o=l.getFullYear();t.displayName="".concat(a," - ").concat(n," ").concat(o),t.iso="".concat(i,"Q").concat(s),t.id=t.iso,r.push(t),l.setDate(0),s-=1}return r=n?t(r):r,r=o?r:r.reverse(),r},Se=e=>t=>{let a=[];const r=t.filterFuturePeriods,n=t.reversePeriods,o=me(t.offset);let i={};return i.startDate="".concat(o,"-01-01"),i.endDate="".concat(o,"-06-30"),i.displayName="".concat(ge(0)," - ").concat(ge(5)," ").concat(o),i.iso="".concat(o,"S1"),i.id=i.iso,a.push(i),i={},i.startDate="".concat(o,"-07-01"),i.endDate="".concat(o,"-12-31"),i.displayName="".concat(ge(6)," - ").concat(ge(11)," ").concat(o),i.iso="".concat(o,"S2"),i.id=i.iso,a.push(i),a=r?e(a):a,a=n?a.reverse():a,a},Ee=e=>t=>{let a=[];const r=t.filterFuturePeriods,n=t.reversePeriods,o=me(t.offset);let i={};return i.startDate="".concat(o,"-04-01"),i.endDate="".concat(o,"-09-30"),i.displayName="".concat(ge(3)," - ").concat(ge(8)," ").concat(o),i.iso="".concat(o,"AprilS1"),i.id=i.iso,a.push(i),i={},i.startDate="".concat(o,"-10-01"),i.endDate="".concat(o+1,"-03-31"),i.displayName="".concat(ge(9)," ").concat(o," - ").concat(ge(2)," ").concat(o+1),i.iso="".concat(o,"AprilS2"),i.id=i.iso,a.push(i),a=r?e(a):a,a=n?a.reverse():a,a},Fe=(e,t)=>a=>{let r=[];const n=a.filterFuturePeriods,o=a.reversePeriods,i=me(a.offset),l=new Date("31 Dec ".concat(i));for(;i-l.getFullYear()<10;){const t={};t.endDate=e(l),l.setMonth(0,1),t.startDate=e(l);const a=l.getFullYear().toString();t.displayName=a,t.iso=l.getFullYear().toString(),t.id=t.iso.toString(),r.push(t),l.setDate(0)}return r=n?t(r):r,r=o?r:r.reverse(),r},Ne=(e,t)=>a=>{let r=[];const n=a.filterFuturePeriods,o=a.reversePeriods,i=me(a.offset),l=new Date("30 Sep ".concat(i+1));for(let t=0;t<10;t++){const t={};t.endDate=e(l),l.setYear(l.getFullYear()-1),l.setDate(l.getDate()+1),t.startDate=e(l);const a=l.getFullYear(),n=l.getFullYear()+1;t.displayName="".concat(ge(9)," ").concat(a," - ").concat(ge(8)," ").concat(n),t.id="".concat(l.getFullYear(),"Oct"),r.push(t),l.setDate(l.getDate()-1)}return r=n?t(r):r,r=o?r:r.reverse(),r},Oe=(e,t)=>a=>{let r=[];const n=a.filterFuturePeriods,o=a.reversePeriods,i=me(a.offset),l=new Date("31 Oct ".concat(i+1));for(let t=0;t<10;t++){const t={};t.endDate=e(l),l.setYear(l.getFullYear()-1),l.setDate(l.getDate()+1),t.startDate=e(l);const a=l.getFullYear(),n=l.getFullYear()+1;t.displayName="".concat(ge(10)," ").concat(a," - ").concat(ge(9)," ").concat(n),t.id="".concat(l.getFullYear(),"Nov"),r.push(t),l.setDate(l.getDate()-1)}return r=n?t(r):r,r=o?r:r.reverse(),r},we=(e,t)=>a=>{let r=[];const n=a.filterFuturePeriods,o=a.reversePeriods,i=me(a.offset),l=new Date("30 Jun ".concat(i+1));for(let t=0;t<10;t++){const t={};t.endDate=e(l),l.setYear(l.getFullYear()-1),l.setDate(l.getDate()+1),t.startDate=e(l);const a=l.getFullYear(),n=l.getFullYear()+1;t.displayName="".concat(ge(6)," ").concat(a," - ").concat(ge(5)," ").concat(n),t.id="".concat(l.getFullYear(),"July"),r.push(t),l.setDate(l.getDate()-1)}return r=n?t(r):r,r=o?r:r.reverse(),r},Pe=(e,t)=>a=>{let r=[];const n=a.filterFuturePeriods,o=a.reversePeriods,i=me(a.offset),l=new Date("31 Mar ".concat(i+1));for(let t=0;t<10;t++){const t={};t.endDate=e(l),l.setYear(l.getFullYear()-1),l.setDate(l.getDate()+1),t.startDate=e(l);const a=l.getFullYear(),n=l.getFullYear()+1;t.displayName="".concat(ge(3)," ").concat(a," - ").concat(ge(2)," ").concat(n),t.id="".concat(l.getFullYear(),"April"),r.push(t),l.setDate(l.getDate()-1)}return r=n?t(r):r,r=o?r:r.reverse(),r},Ce=e=>{const t=e.getFullYear();let a=String(e.getMonth()+1),r=String(e.getDate());return a=a.length<2?"0".concat(a):a,r=r.length<2?"0".concat(r):r,"".concat(t,"-").concat(a,"-").concat(r)},Ye=e=>{const t=[],a=pe();for(let r=0;r<e.length;r++)new Date(e[r].startDate)<=a&&t.push(e[r]);return t},_e=function(){let{formatYyyyMmDd:e=Ce,filterFuturePeriods:t=Ye}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[{type:V,regex:/^([0-9]{4})([0-9]{2})([0-9]{2})$/,getPeriods:fe(e,t),displayName:h.a.t("Daily")},{type:G,regex:/^([0-9]{4})()W([0-9]{1,2})$/,getPeriods:ye(e,{shortName:"",startDay:1},t),displayName:h.a.t("Weekly")},{type:K,regex:/^([0-9]{4})(Wed)W([0-9]{1,2})$/,getPeriods:ye(e,{shortName:"Wed",startDay:3},t),displayName:h.a.t("Weekly (Start Wednesday)")},{type:z,regex:/^([0-9]{4})(Thu)W([0-9]{1,2})$/,getPeriods:ye(e,{shortName:"Thu",startDay:4},t),displayName:h.a.t("Weekly (Start Thursday)")},{type:H,regex:/^([0-9]{4})(Sat)W([0-9]{1,2})$/,getPeriods:ye(e,{shortName:"Sat",startDay:6},t),displayName:h.a.t("Weekly (Start Saturday)")},{type:X,regex:/^([0-9]{4})(Sun)W([0-9]{1,2})$/,getPeriods:ye(e,{shortName:"Sun",startDay:7},t),displayName:h.a.t("Weekly (Start Sunday)")},{type:Z,regex:/^([0-9]{4})BiW([0-9]{1,2})$/,getPeriods:he(e,t),displayName:h.a.t("Bi-weekly")},{type:ee,regex:/^([0-9]{4})([0-9]{2})$/,getPeriods:ve(e,t),displayName:h.a.t("Monthly")},{type:te,regex:/^([0-9]{4})([0-9]{2})B$/,getPeriods:De(e,t),displayName:h.a.t("Bi-monthly")},{type:ae,regex:/^([0-9]{4})Q([1234])$/,getPeriods:be(e,t),displayName:h.a.t("Quarterly")},{type:re,regex:/^([0-9]{4})S([12])$/,getPeriods:Se(t),displayName:h.a.t("Six-monthly")},{type:ne,regex:/^([0-9]{4})AprilS([12])$/,getPeriods:Ee(t),displayName:h.a.t("Six-monthly April")},{type:oe,regex:/^([0-9]{4})$/,getPeriods:Fe(e,t),displayName:h.a.t("Yearly")},{type:ce,regex:/^([0-9]{4})Nov$/,getPeriods:Oe(e,t),displayName:h.a.t("Financial year (Start November)")},{type:se,regex:/^([0-9]{4})Oct$/,getPeriods:Ne(e,t),displayName:h.a.t("Financial year (Start October)")},{type:le,regex:/^([0-9]{4})July$/,getPeriods:we(e,t),displayName:h.a.t("Financial year (Start July)")},{type:ie,regex:/^([0-9]{4})April$/,getPeriods:Pe(e,t),displayName:h.a.t("Financial year (Start April)")}]},xe=e=>{const t=parseInt(e,10);if(!Number.isInteger(t))throw new Error('Invalid year "'.concat(e,'" passed to "getYearOffsetFromNow"'));return t-pe().getFullYear()},je=e=>{let{periodType:t,year:a,formatYyyyMmDd:r,filterFuturePeriods:n,config:o}=e;const i=(e=>{let{periodType:t,formatYyyyMmDd:a,filterFuturePeriods:r}=e;if(!ue(t))throw new Error('Invalid period type "'.concat(t,'" supplied to "getFixedPeriodType"'));const n=_e({formatYyyyMmDd:a,filterFuturePeriods:r}).find((e=>{let{type:a}=e;return a===t}));if(!n)throw new Error('Could not find periodType object for "'.concat(t,'"'));return n})({periodType:t,formatYyyyMmDd:r,filterFuturePeriods:n}),l=xe(a);return i&&Number.isInteger(l)?i.getPeriods({...o,offset:l}):[]},ke=e=>!isNaN(e.getTime()),Ie=(e,t,a)=>{if(t=new Date(t),a=new Date(a),!ke(t))throw new Error("Invalid startDate provided to getFixedPeriodsForTypeAndDateRange");if(!ke(a))throw new Error("Invalid endDate provided to getFixedPeriodsForTypeAndDateRange");let r=a.getFullYear(),n=!1;const o=[];for(;!n;)je({periodType:e,year:r}).reverse().forEach((e=>{const r=new Date(e.endDate),i=r>=t;i||(n=!0),i&&r<=a&&o.push(e)})),--r;return o.reverse()};function Me(e){return Object(n.useMemo)((()=>((e,t)=>{if(!e)return null;const a=t?_e().filter((e=>{let{type:a}=e;return t.some((e=>e===a))})):_e();let r,n,o=0;for(;o<a.length&&!n;)r=a[o],n=e.match(r.regex),o++;if(!n)return null;const i=parseInt(n[1],10),l=xe(i);return{...r.getPeriods({offset:l}).find((t=>t.id===e)),year:i,periodType:r}})(e)),[e])}function Te(e){return e?function(e){if(!ue(e))throw new Error('Invalid periodType "'.concat(e,'" supplied to "getMostRecentCompletedYear"'));const t=pe();let a=t.getFullYear(),r=Ie(e,"".concat(t.getFullYear(),"-01-01"),t);if(r.length>0)return a;for(;0===r.length;)--a,r=Ie(e,"".concat(a,"-01-01"),"".concat(a,"-12-31"));return a}(e):null}var We=a(7),Ue=a(33),Ae=a.n(Ue),Re=a(693),Qe=a.n(Re);function $e(e){let{periodType:t,year:a,onChange:n}=e;const[i]=p(),l=Me(i),{systemInfo:{dateFormat:s}}=Object(We.e)(),c=(e=>{let{periodType:t,year:a,dateFormat:r}=e;return je({periodType:t,year:a,formatYyyyMmDd:e=>"Daily"===t?Ae()(e).format(r.toUpperCase()):Ae()(e).format("YYYY-MM-DD"),config:{reversePeriods:!0}})})({periodType:t,year:a,dateFormat:s});return o.a.createElement(r.n,{dense:!0,className:Qe.a.menu},c.map((e=>o.a.createElement(r.o,{active:e.id===(null===l||void 0===l?void 0:l.id),key:e.id,label:e.displayName,onClick:()=>n({selected:e.id})}))))}const Je={dataSet:{resource:"dataSets",id:e=>{let{id:t}=e;return t},params:{fields:["periodType"]}}};function Le(){const[e]=u(),t=[Je,{id:e}],{isLoading:a,error:r,data:n}=Object(i.useQuery)(t,{enabled:!!e});return{loading:a,error:r,data:null===n||void 0===n?void 0:n.dataSet.periodType}}var Be=a(694),qe=a.n(Be);function Ve(e){let{maxYear:t,year:a,onYearChange:n}=e;return o.a.createElement("div",{className:qe.a.container},o.a.createElement(r.c,{disabled:1970===a,onClick:()=>n(a-1),icon:o.a.createElement(r.j,null)}),o.a.createElement("span",{className:qe.a.year},a),o.a.createElement(r.c,{disabled:a===t,onClick:()=>n(a+1),icon:o.a.createElement(r.k,null)}))}const Ge=()=>{const[e,t]=Object(n.useState)(!1),[a,i]=p(),[l]=u(),s=Le(),[c,d]=Object(n.useState)((()=>Te(s.data))),g=Me(a),[f,y]=Object(n.useState)((null===g||void 0===g?void 0:g.year)||c);Object(n.useEffect)((()=>{null!==g&&void 0!==g&&g.year&&y(g.year)}),[null===g||void 0===g?void 0:g.year]),Object(n.useEffect)((()=>{if(s.data){const e=Te(s.data);d(e),null!==g&&void 0!==g&&g.year||y(e)}}),[s.data]);const v=function(){const[e]=p(),t=Le(),a=Me(e);return t.loading?h.a.t("Fetching data set info"):t.error?h.a.t("Error occurred while loading data set info"):null===a||void 0===a?void 0:a.displayName}();return function(){const e=Object(n.useRef)(!0),[t,a]=Object(n.useState)(""),[r]=u(),{loadingDataSetPeriodType:o,errorDataSetPeriodType:i,periodType:l}=Le(),[,s]=m();Object(n.useEffect)((()=>{e.current?e.current=!1:o||i||t===l||(s([]),a(l))}),[o,i,r,e,t])}(),o.a.createElement(r.w,{disabled:!l,label:h.a.t("Period"),value:a?v:void 0,open:e,setOpen:t,noValueMessage:h.a.t("Choose a period")},f?o.a.createElement(o.a.Fragment,null,o.a.createElement(Ve,{maxYear:c,year:f,onYearChange:e=>{i(null),y(e)}}),o.a.createElement($e,{onChange:e=>{let{selected:a}=e;i(a),t(!1)},periodType:s.data,year:f})):o.a.createElement("div",null))},Ke={dataSet:{resource:"dataSets",id:e=>{let{id:t}=e;return t},params:{fields:["formType","sections[id,displayName]"]}}};function ze(){const[e]=u(),t=[Ke,{id:e}],{isIdle:a,isLoading:r,error:n,data:o}=Object(i.useQuery)(t,{enabled:!!e});return{called:!a,data:(null===o||void 0===o?void 0:o.dataSet)||null,loading:r,error:n}}function He(){var e;const[t,a]=Object(n.useState)(!1),[i,l]=f(),s=ze(),c=!s.called||s.loading,d=function(){const[e]=f(),t=ze();if(!e)return;if(!t.called||t.loading)return h.a.t("Fetching data set info");if(t.error)return h.a.t("Error occurred while loading data set info");if(!t.data)return;const{sections:a}=t.data,r=a.find((t=>{let{id:a}=t;return a===e}));return null===r||void 0===r?void 0:r.displayName}();!function(e){const t=Object(n.useRef)(!0),[a]=u(),[r]=p(),[o]=g(),[i]=m();Object(n.useEffect)((()=>{t.current?t.current=!1:e()}),[a,o,r,i])}((()=>l(void 0)));const y=function(){var e,t;const a=ze();return!a.called||"SECTION"!==(null===(e=a.data)||void 0===e?void 0:e.formType)||0===(null===(t=a.data)||void 0===t?void 0:t.sections.length)}();if(y)return null;const v=!s.loading&&!s.error&&s.data,D=(null===(e=s.data)||void 0===e?void 0:e.sections.map((e=>{let{id:t,displayName:a}=e;return{value:t,label:a}})))||[],b=[{value:"",label:h.a.t("Show all sections")},...D];return o.a.createElement(r.w,{disabled:c||s.error,label:h.a.t("Section filter"),value:d,open:t,setOpen:a,noValueMessage:h.a.t("Choose a section filter")},v?o.a.createElement(P,{values:b,selected:i,onChange:e=>{let{selected:t}=e;l(t),a(!1)}}):o.a.createElement("div",null))}function Xe(){const e=function(){const[e]=y();return!(e.orgUnitId||e.periodId||e.attributeOptionComboSelection.length||e.sectionFilter)}(),t=function(){const[,e]=y();return Object(n.useCallback)((()=>{e({dataSetId:"",orgUnitId:"",periodId:"",attributeOptionComboSelection:[],sectionFilter:""})}),[e])}(),a=e?void 0:t;return o.a.createElement(r.v,{onClearSelectionClick:a},o.a.createElement(_,null),o.a.createElement(q,null),o.a.createElement(Ge,null),o.a.createElement(N,null),o.a.createElement(He,null))}var Ze=a(5),et=a.n(Ze),tt=a(695),at=a.n(tt);var rt=e=>{let{header:t,main:a,sidebar:r,footer:n,showSidebar:i,showFooter:l}=e;const s=et()(at.a.wrapper,{[at.a.showSidebar]:i,[at.a.showFooter]:l});return o.a.createElement("div",{className:s},o.a.createElement("header",{className:at.a.header},t),o.a.createElement("main",{className:at.a.main},a),o.a.createElement("aside",{className:at.a.sidebar},r),l&&o.a.createElement("footer",{className:at.a.footer},n))};var nt=()=>{const e=Object(We.f)();return new i.QueryClient({defaultOptions:{queries:{queryFn:t=>{let{queryKey:a}=t;const[r,n]=a;return e.query(r,{variables:n})}}}})};t.default=()=>{const e=nt();return o.a.createElement(i.QueryClientProvider,{client:e},o.a.createElement(l.a,null,o.a.createElement(c.b,{ReactRouterRoute:s.a},o.a.createElement(r.h,{colors:!0,spacers:!0}),o.a.createElement(rt,{header:o.a.createElement(Xe,null),main:"",sidebar:"",footer:"",showSidebar:!0,showFooter:!0}))))}}}]);
//# sourceMappingURL=app.3607a167.chunk.js.map